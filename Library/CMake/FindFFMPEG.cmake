# find_ffmpeg(RELEASE_ROOT_DIR DEBUG_ROOT_DIR)
#
# This function locates the Libz library, using a couple of provided paths for searching.
#
# Usage:
#	find_ffmpeg(RELEASE_ROOT_DIR DEBUG_ROOT_DIR)
# Where:
#	RELEASE_ROOT_DIR = The directory containing the RELEASE version of the library, or library's linker file.
#	DEBUG_ROOT_DIR = The directory containing the DEBUG version of the library, or library's linker file.
# What it produces:
#	AVCODEC_RELEASE_LIBRARY, AVCODEC_DEBUG_LIBRARY and in the case of SHARED LIBRARIES - 
#	AVCODEC_RELEASE_DLL, and AVCODEC_DEBUG_DLL. Which each points to the respective files of each kind.
#	AVFORMAT_RELEASE_LIBRARY, AVFORMAT_DEBUG_LIBRARY and in the case of SHARED LIBRARIES - 
#	AVFORMAT_RELEASE_DLL, and AVFORMAT_DEBUG_DLL. Which each points to the respective files of each kind.
#	AVUTIL_RELEASE_LIBRARY, AVUTIL_DEBUG_LIBRARY and in the case of SHARED LIBRARIES - 
#	AVUTIL_RELEASE_DLL, and AVUTIL_DEBUG_DLL. Which each points to the respective files of each kind.
#	SWRESAMPLE_RELEASE_LIBRARY, SWRESAMPLE_DEBUG_LIBRARY and in the case of SHARED LIBRARIES - 
#	SWRESAMPLE_RELEASE_DLL, and SWRESAMPLE_DEBUG_DLL. Which each points to the respective files of each kind.
#
function(find_ffmpeg RELEASE_ROOT_DIR DEBUG_ROOT_DIR)
	find_library(
		AVCODEC_RELEASE_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avcodec${LIBRARY_SUFFIX}" 
		PATHS "${RELEASE_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		AVCODEC_DEBUG_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avcodec${LIBRARY_SUFFIX}" 
		PATHS "${DEBUG_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		AVFORMAT_RELEASE_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avformat${LIBRARY_SUFFIX}"
		PATHS "${RELEASE_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		AVFORMAT_DEBUG_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avformat${LIBRARY_SUFFIX}"
		PATHS "${DEBUG_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		AVUTIL_RELEASE_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avutil${LIBRARY_SUFFIX}" 
		PATHS "${RELEASE_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		AVUTIL_DEBUG_LIBRARY 
		NAMES "${LIBRARY_PREFIX}avutil${LIBRARY_SUFFIX}"
		PATHS "${DEBUG_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		SWRESAMPLE_RELEASE_LIBRARY 
		NAMES "${LIBRARY_PREFIX}swresample${LIBRARY_SUFFIX}"
		PATHS "${RELEASE_ROOT_DIR}" NO_DEFAULT_PATH
	)
	find_library(
		SWRESAMPLE_DEBUG_LIBRARY 
		NAMES "${LIBRARY_PREFIX}swresample${LIBRARY_SUFFIX}"
		PATHS "${DEBUG_ROOT_DIR}" NO_DEFAULT_PATH
	)
	if (AVCODEC_RELEASE_LIBRARY AND AVCODEC_DEBUG_LIBRARY AND AVFORMAT_RELEASE_LIBRARY AND AVFORMAT_DEBUG_LIBRARY AND AVUTIL_RELEASE_LIBRARY
		AND AVUTIL_DEBUG_LIBRARY AND SWRESAMPLE_RELEASE_LIBRARY AND SWRESAMPLE_DEBUG_LIBRARY)
		cmake_path(GET AVCODEC_RELEASE_LIBRARY FILENAME AVCODEC_RELEASE_LIBRARY_NAME)
		cmake_path(GET AVCODEC_RELEASE_LIBRARY PARENT_PATH AVCODEC_RELEASE_FILE_PATH)
		cmake_path(RELATIVE_PATH AVCODEC_RELEASE_FILE_PATH OUTPUT_VARIABLE AVCODEC_RELEASE_LIBRARY_NEW)
		cmake_path(GET AVCODEC_DEBUG_LIBRARY FILENAME AVCODEC_DEBUG_LIBRARY_NAME)
		cmake_path(GET AVCODEC_DEBUG_LIBRARY PARENT_PATH AVCODEC_DEBUG_FILE_PATH)
		cmake_path(RELATIVE_PATH AVCODEC_DEBUG_FILE_PATH OUTPUT_VARIABLE AVCODEC_DEBUG_LIBRARY_NEW)
		list(APPEND RELEASE_LIBRARIES "${AVCODEC_RELEASE_LIBRARY_NEW}/${AVCODEC_RELEASE_LIBRARY_NAME}")
		list(APPEND DEBUG_LIBRARIES "${AVCODEC_DEBUG_LIBRARY_NEW}/${AVCODEC_DEBUG_LIBRARY_NAME}")
		cmake_path(GET AVFORMAT_RELEASE_LIBRARY FILENAME AVFORMAT_RELEASE_LIBRARY_NAME)
		cmake_path(GET AVFORMAT_RELEASE_LIBRARY PARENT_PATH AVFORMAT_RELEASE_FILE_PATH)
		cmake_path(RELATIVE_PATH AVFORMAT_RELEASE_FILE_PATH OUTPUT_VARIABLE AVFORMAT_RELEASE_LIBRARY_NEW)
		cmake_path(GET AVFORMAT_DEBUG_LIBRARY FILENAME AVFORMAT_DEBUG_LIBRARY_NAME)
		cmake_path(GET AVFORMAT_DEBUG_LIBRARY PARENT_PATH AVFORMAT_DEBUG_FILE_PATH)
		cmake_path(RELATIVE_PATH AVFORMAT_DEBUG_FILE_PATH OUTPUT_VARIABLE AVFORMAT_DEBUG_LIBRARY_NEW)
		list(APPEND RELEASE_LIBRARIES "${AVFORMAT_RELEASE_LIBRARY_NEW}/${AVFORMAT_RELEASE_LIBRARY_NAME}")
		list(APPEND DEBUG_LIBRARIES "${AVFORMAT_DEBUG_LIBRARY_NEW}/${AVFORMAT_DEBUG_LIBRARY_NAME}")
		cmake_path(GET AVUTIL_RELEASE_LIBRARY FILENAME AVUTIL_RELEASE_LIBRARY_NAME)
		cmake_path(GET AVUTIL_RELEASE_LIBRARY PARENT_PATH AVUTIL_RELEASE_FILE_PATH)
		cmake_path(RELATIVE_PATH AVUTIL_RELEASE_FILE_PATH OUTPUT_VARIABLE AVUTIL_RELEASE_LIBRARY_NEW)
		cmake_path(GET AVUTIL_DEBUG_LIBRARY FILENAME AVUTIL_DEBUG_LIBRARY_NAME)
		cmake_path(GET AVUTIL_DEBUG_LIBRARY PARENT_PATH AVUTIL_DEBUG_FILE_PATH)
		cmake_path(RELATIVE_PATH AVUTIL_DEBUG_FILE_PATH OUTPUT_VARIABLE AVUTIL_DEBUG_LIBRARY_NEW)
		list(APPEND RELEASE_LIBRARIES "${AVUTIL_RELEASE_LIBRARY_NEW}/${AVUTIL_RELEASE_LIBRARY_NAME}")
		list(APPEND DEBUG_LIBRARIES "${AVUTIL_DEBUG_LIBRARY_NEW}/${AVUTIL_DEBUG_LIBRARY_NAME}")
		cmake_path(GET SWRESAMPLE_RELEASE_LIBRARY FILENAME SWRESAMPLE_RELEASE_LIBRARY_NAME)
		cmake_path(GET SWRESAMPLE_RELEASE_LIBRARY PARENT_PATH SWRESAMPLE_RELEASE_FILE_PATH)
		cmake_path(RELATIVE_PATH SWRESAMPLE_RELEASE_FILE_PATH OUTPUT_VARIABLE SWRESAMPLE_RELEASE_LIBRARY_NEW)
		cmake_path(GET SWRESAMPLE_DEBUG_LIBRARY FILENAME SWRESAMPLE_DEBUG_LIBRARY_NAME)
		cmake_path(GET SWRESAMPLE_DEBUG_LIBRARY PARENT_PATH SWRESAMPLE_DEBUG_FILE_PATH)
		cmake_path(RELATIVE_PATH SWRESAMPLE_DEBUG_FILE_PATH OUTPUT_VARIABLE SWRESAMPLE_DEBUG_LIBRARY_NEW)
		list(APPEND RELEASE_LIBRARIES "${SWRESAMPLE_RELEASE_LIBRARY_NEW}/${SWRESAMPLE_RELEASE_LIBRARY_NAME}")
		list(APPEND DEBUG_LIBRARIES "${SWRESAMPLE_DEBUG_LIBRARY_NEW}/${SWRESAMPLE_DEBUG_LIBRARY_NAME}")
		set(RELEASE_LIBRARIES "${RELEASE_LIBRARIES}" PARENT_SCOPE)
		set(DEBUG_LIBRARIES  "${DEBUG_LIBRARIES}" PARENT_SCOPE)
		message(STATUS "Found FFMPEG libraries!")
	else()
		message(FATAL_ERROR "Couldn't find FFMPEG!")
		return()
	endif()
	if (WIN32)
		cmake_path(GET AVCODEC_RELEASE_LIBRARY PARENT_PATH AVCODEC_RELEASE_FILE_PATH)
		find_file(
			AVCODEC_RELEASE_DLL
			NAMES "avcodec-58.dll" "libavcodec-58.dll"
			PATHS "${AVCODEC_RELEASE_FILE_PATH}/" "${AVCODEC_RELEASE_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		cmake_path(GET AVCODEC_DEBUG_LIBRARY PARENT_PATH AVCODEC_DEBUG_FILE_PATH)
		find_file(
			AVCODEC_DEBUG_DLL
			NAMES "avcodec-58.dll" "libavcodec-58.dll"
			PATHS "${AVCODEC_DEBUG_FILE_PATH}/" "${AVCODEC_DEBUG_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)		
		cmake_path(GET AVFORMAT_RELEASE_LIBRARY PARENT_PATH AVFORMAT_RELEASE_FILE_PATH)
		find_file(
			AVFORMAT_RELEASE_DLL
			NAMES "avformat-58.dll" "libavformat-58.dll"
			PATHS "${AVFORMAT_RELEASE_FILE_PATH}/" "${AVFORMAT_RELEASE_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		cmake_path(GET AVFORMAT_DEBUG_LIBRARY PARENT_PATH AVFORMAT_DEBUG_FILE_PATH)
		find_file(
			AVFORMAT_DEBUG_DLL
			NAMES "avformat-58.dll" "avformat-58.dll"
			PATHS "${AVFORMAT_DEBUG_FILE_PATH}/" "${AVFORMAT_DEBUG_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		cmake_path(GET AVUTIL_RELEASE_LIBRARY PARENT_PATH AVUTIL_RELEASE_FILE_PATH)
		find_file(
			AVUTIL_RELEASE_DLL
			NAMES "avutil-56.dll" "libavutil-56.dll"
			PATHS "${AVUTIL_RELEASE_FILE_PATH}/" "${AVUTIL_RELEASE_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		cmake_path(GET AVUTIL_DEBUG_LIBRARY PARENT_PATH AVUTIL_DEBUG_FILE_PATH)
		find_file(
			AVUTIL_DEBUG_DLL
			NAMES "avutil-56.dll" "libavutil-56.dll"
			PATHS "${AVUTIL_DEBUG_FILE_PATH}/" "${AVUTIL_DEBUG_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)		
		cmake_path(GET SWRESAMPLE_RELEASE_LIBRARY PARENT_PATH SWRESAMPLE_RELEASE_FILE_PATH)
		find_file(
			SWRESAMPLE_RELEASE_DLL
			NAMES "swresample-3.dll" "libswresample-3.dll"
			PATHS "${SWRESAMPLE_RELEASE_FILE_PATH}/" "${SWRESAMPLE_RELEASE_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		cmake_path(GET SWRESAMPLE_DEBUG_LIBRARY PARENT_PATH SWRESAMPLE_DEBUG_FILE_PATH)
		find_file(
			SWRESAMPLE_DEBUG_DLL
			NAMES "swresample-3.dll" "libswresample-3.dll"
			PATHS "${SWRESAMPLE_DEBUG_FILE_PATH}/" "${SWRESAMPLE_DEBUG_FILE_PATH}/../bin/"
			NO_DEFAULT_PATH
		)
		if (AVCODEC_RELEASE_DLL AND AVCODEC_DEBUG_DLL AND AVFORMAT_RELEASE_DLL AND AVFORMAT_DEBUG_DLL 
			AND AVUTIL_RELEASE_DLL AND AVUTIL_DEBUG_DLL AND SWRESAMPLE_RELEASE_DLL AND SWRESAMPLE_DEBUG_DLL)
			list(APPEND LIBRARY_NAMES "AVFORMAT")
			list(APPEND LIBRARY_NAMES "AVCODEC")
			list(APPEND LIBRARY_NAMES "AVUTIL")
			list(APPEND LIBRARY_NAMES "SWRESAMPLE")
			set(LIBRARY_NAMES "${LIBRARY_NAMES}" PARENT_SCOPE)
			list(APPEND RELEASE_DLLS "${AVFORMAT_RELEASE_DLL}")
			list(APPEND DEBUG_DLLS  "${AVFORMAT_DEBUG_DLL}")
			list(APPEND RELEASE_DLLS "${AVCODEC_RELEASE_DLL}")
			list(APPEND DEBUG_DLLS  "${AVCODEC_DEBUG_DLL}")
			list(APPEND RELEASE_DLLS "${AVUTIL_RELEASE_DLL}")
			list(APPEND DEBUG_DLLS  "${AVUTIL_DEBUG_DLL}")
			list(APPEND RELEASE_DLLS "${SWRESAMPLE_RELEASE_DLL}")
			list(APPEND DEBUG_DLLS  "${SWRESAMPLE_DEBUG_DLL}")
			set(RELEASE_DLLS "${RELEASE_DLLS}" PARENT_SCOPE)
			set(DEBUG_DLLS  "${DEBUG_DLLS}" PARENT_SCOPE)
			message(STATUS "Found FFMPEG Dlls!")
		else()
			list(APPEND LIBRARY_NAMES "AVFORMAT")
			list(APPEND LIBRARY_NAMES "AVCODEC")
			list(APPEND LIBRARY_NAMES "AVUTIL")
			list(APPEND LIBRARY_NAMES "SWRESAMPLE")
			set(LIBRARY_NAMES "${LIBRARY_NAMES}" PARENT_SCOPE)
			list(APPEND RELEASE_DLLS "NOTFOUND")
			list(APPEND DEBUG_DLLS  "NOTFOUND")
			list(APPEND RELEASE_DLLS "NOTFOUND")
			list(APPEND DEBUG_DLLS  "NOTFOUND")
			list(APPEND RELEASE_DLLS "NOTFOUND")
			list(APPEND DEBUG_DLLS  "NOTFOUND")
			list(APPEND RELEASE_DLLS "NOTFOUND")
			list(APPEND DEBUG_DLLS  "NOTFOUND")
			set(RELEASE_DLLS "${RELEASE_DLLS}" PARENT_SCOPE)
			set(DEBUG_DLLS  "${DEBUG_DLLS}" PARENT_SCOPE)
			unset(AVCODEC_RELEASE_DLL CACHE)
			unset(AVCODEC_DEBUG_DLL CACHE)
			unset(AVFORMAT_RELEASE_DLL CACHE)
			unset(AVFORMAT_DEBUG_DLL CACHE)
			unset(AVUTIL_RELEASE_DLL CACHE)
			unset(AVUTIL_DEBUG_DLL CACHE)
			unset(SWRESAMPLE_RELEASE_DLL CACHE)
			unset(SWRESAMPLE_DEBUG_DLL CACHE)
			message(STATUS "Couldn't find FFMPEG Dlls - linking statically!")
		endif()
	endif()
endfunction()